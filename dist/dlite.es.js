/* dlite v0.15.0 */
const t=(t,e,r)=>{let n=t;const o=e.split(".");for(;o.length;){const t=o.shift();n[t]=o.length?n[t]?n[t]:{}:r,n=n[t]}},e=(t,e)=>e.split(".").reduce(((t,e)=>t&&t[e]),t),r=t=>"function"==typeof t,n=(t,e)=>t&&r(t[e]),o=t=>{const e=(new DOMParser).parseFromString(t,"text/html");return{head:e.head,body:e.body}},i=[["&lt;","<"],["&gt;",">"],["&amp;","&"]],s=(t,e=!1)=>Object.freeze(Array.from(t.attributes).map((t=>{return{[e?(r=t.name,r.replace(/[-_\s+]([a-z])/g,(t=>t[1].toUpperCase()))):t.name]:t.value};var r})).reduce(((t,e)=>({...t,...e})),{})),l=(t,e)=>{let r=!1,n=!1;const o=new WeakMap,i=()=>{r?n||(n=!0):e()},s={get(t,e,r){if("#"===e)return t;const n=Reflect.get(t,e,r);if((t=>null===t||!["function","object"].includes(typeof t))(n)||"constructor"===e)return n;const i=((t,e)=>{let r=o.get(t);if(r)return r;r=new Map,o.set(t,r);let n=r.get(e);return n||(n=Reflect.getOwnPropertyDescriptor(t,e),r.set(e,n)),n})(t,e);if(i&&!i.configurable){if(i.set&&!i.get)return;if(!1===i.writable)return n}return new Proxy(n,s)},set(t,e,r,n){r&&void 0!==r["#"]&&(r=r["#"]);const o=Reflect.get(t,e,n),s=Reflect.set(t,e,r);return o!==r&&i(),s},defineProperty(t,e,r){const n=Reflect.defineProperty(t,e,r);return i(),n},deleteProperty(t,e){const r=Reflect.deleteProperty(t,e);return i(),r},apply(t,o,i){if(!r){r=!0;const s=Reflect.apply(t,o,i);return n&&e(),r=n=!1,s}return Reflect.apply(t,o,i)}};return new Proxy(t,s)};function c(t){return null===t||"object"!=typeof t?t:(Object.keys(t).forEach((function(e){const r=t[e];null!==r&&"object"==typeof r&&c(r)})),Object.freeze(t))}const a=t=>c(function(t){if(null===t||"object"!=typeof t)return t;var e=t.constructor();for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=a(t[r]));return e}(t)),u=[];for(const t in document){const e=null===document[t]||r(document[t]);t.startsWith("on")&&e&&u.push(t.substring(2))}const d="dl--elist",f=t=>`dl--on-${t}`;const p=(t,e)=>Array.from(t.childNodes).filter((t=>e(t))).map((t=>({[e(t)]:t}))).reduce(((t,e)=>({...t,...e})),{}),h=t=>t instanceof HTMLElement&&t.hasAttribute("ref-key")?t.getAttribute("ref-key"):t.id;function b(t,e,r={}){if(r={key:t=>h(t),...r},"string"==typeof e){const r=e;(e=document.createElement(t.nodeName)).innerHTML=r}const n=p(t,r.key);let o;for(o=0;e.firstChild;o++){const i=e.removeChild(e.firstChild);if(o>=t.childNodes.length){t.appendChild(i);continue}let l=t.childNodes[o];const c=r.key(i);if(r.key(l)||c){const e=c&&c in n?n[c]:i;e!==l&&(l=t.insertBefore(e,l))}if(l.nodeType!==i.nodeType||l.tagName!==i.tagName)t.replaceChild(i,l);else if([Node.TEXT_NODE,Node.COMMENT_NODE].indexOf(l.nodeType)>=0)l.textContent!==i.textContent&&(l.textContent=i.textContent);else if(l!==i){const t=s(l),e=s(i);for(const r in t)r in e||l.removeAttribute(r);for(const r in e)r in t&&t[r]===e[r]||l.setAttribute(r,e[r]);b(l,i)}}for(;t.childNodes.length>o;)t.removeChild(t.lastChild);return!0}const m={$key:function(t,e,r){t.setAttribute("ref-key",e),A(t,r)},$class:function(t,e,r){const n=e.split(";").map((t=>t.split(":",2).map((t=>t.trim())))).map((t=>`\${${t[1]} ? '${t[0]}': ''}`)).join(" "),o=(t.getAttribute("class")||"")+` ${n}`;t.setAttribute("class",o),A(t,r)},$style:function(t,e,r){const n=t.getAttribute("style")||"",o=`\${function() { return this.__$styleMap(${e});}.call(this)}`;t.setAttribute("style",(n?n+"; ":"")+o),A(t,r)},$for:function(t,e,r){const n=/(.*)\s+(in)\s+(.*)$/.exec(e);if(4===n.length){const e=n[1].replace("(","").replace(")",""),o=n[3];M(t,`\${${o}.map(function(${e}) { return \``,"`}.bind(this)).join('')}"),A(t,r)}},$if:function(t,e,r){A(t,r),w(t,`\${${e} ? `);const n=t.nextElementSibling;n&&g(n,"else")?(M(t,"`","`"),A(n,"else"),M(n,":`","`}")):M(t,"`","`:``}")},$text:function(t,e,r){t.textContent=e,A(t,r)}},y=t=>`:${t}`,g=(t,e)=>t.hasAttribute(y(e)),$=(t,e)=>t.getAttribute(y(e)),A=(t,e)=>t.removeAttribute(y(e)),v=(t,e)=>t.querySelectorAll(`[\\${y(e)}]`),w=(t,e)=>t.insertAdjacentText("beforebegin",e),M=(t,e,r)=>{w(t,e),((t,e)=>{t.insertAdjacentText("afterend",e)})(t,r)};const x=["data","el","shadowDOM","template","created","updated","removed","$store","prop","tagName"],j=t=>Object.keys(t).filter((t=>!x.includes(t))).filter((t=>!t.startsWith("$"))).filter((e=>n(t,e))).reduce(((e,r)=>({...e,[r]:t[r]})),{}),k=t=>Object.keys(t).filter((e=>!n(t,e))).reduce(((e,r)=>({...e,[r]:t[r]})),{}),E=t=>Object.keys(t).filter((e=>n(t,e))).map((e=>{return r=e,n=t[e],t=>t[r]=n({...t});var r,n})),N=t=>Object.keys(t).filter((t=>t.startsWith("$"))).filter((t=>!x.includes(t))).reduce(((e,r)=>({...e,[r]:t[r]})),{}),T=t=>e=>(e.$store=t.getState(),t.subscribe((r=>e.$store={...t.getState()}))),O=(t,e,r)=>{Object.keys(e).filter((t=>!t.startsWith("_"))).map((n=>t[n]=e[n].bind(r)))},C=t=>{const{head:e,body:r}=o(t);!function(t,e={}){const r={...e,...m};for(const e in r){const n=e.replace("$","");for(const o of v(t,n))if(g(o,n)){const t=$(o,n);r[e](o,t,n)}}}(r),function(t){for(const e of t.querySelectorAll("[\\@call], [\\@bind]")){let t=e.getAttribute("@call");e.removeAttribute("@call"),e.hasAttribute("@bind")&&(e.setAttribute("dl--bind",e.getAttribute("@bind")),e.removeAttribute("@bind"),t="__$bindInput");let r=["click"];e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement?r=["input","paste"]:e instanceof HTMLSelectElement?r=["change"]:e instanceof HTMLFormElement?r=["submit"]:e instanceof HTMLAnchorElement&&e.setAttribute("href","javascript:void(0);");let n=(e.getAttribute(d)||"").split(",").filter((t=>t));n=n.concat(r),e.setAttribute(d,n.join(","));for(const n of r)e.setAttribute(f(n),t)}for(const e of u)for(const r of t.querySelectorAll(`[\\@${e}]`)){const t=(r.getAttribute(d)||"").split(",").filter((t=>t));t.push(e),r.setAttribute(d,t.join(",")),r.setAttribute(f(e),r.getAttribute(`@${e}`)),r.removeAttribute(`@${e}`),r instanceof HTMLAnchorElement&&r.setAttribute("href","javascript:void(0);")}}(r);let n=(t=>t.replace(/\$?\{([^\;\{]+)\}/g,((t,e)=>`\${${e}}`)))((s=r.innerHTML,i.reduce(((t,e)=>t.replace(new RegExp(e[0],"g"),e[1])),s)));var s;e.querySelectorAll("style").forEach((t=>{n+=t.outerHTML}));const l=(c=n,t=>new Function(`return \`${c}\``).call(t));var c;return{html:n,render:(t,e)=>{const{head:r,body:n}=o(l(e));return n.append(...r.querySelectorAll("style")),!t.isEqualNode(n)&&b(t,n)}}};function _(r){const n=r.target,o=n.getAttribute("ld--bind");if("checkbox"===n.type){const r=e(this.data,o)||[];t(this.data,o,n.checked?r.concat(n.value):r.filter((t=>t!=n.value)))}else n.options&&n.multiple?t(this.data,o,[].reduce.call(n,((t,e)=>e.selected?t.concat(e.value):t),[])):t(this.data,o,n.value)}const L={__$styleMap:t=>Object.keys(t).map((e=>{return`${r=e,r.replace(/([a-zA-Z])(?=[A-Z])/g,"$1-").toLowerCase()}: ${t[e]};`;var r})).join(" ")};function S(t={}){const r={shadowDOM:!0,tagName:null,data:{},template:null,$store:{getState:()=>{},subscribe:()=>()=>{}},created(){},updated(){},removed(){},...t},n=T(r.$store),o=C(r.template),i=j(r),c=k(r.data),u=E(r.data),p=N(r),h=t=>u.forEach((e=>e(t)));let b=null;return window.customElements.define(r.tagName.toLowerCase(),class extends HTMLElement{constructor(){super(),this.style.visibility=this.style.visibility?this.style.visibility:"hidden",this.$root=r.shadowDOM?this.attachShadow({mode:"open"}):this,b=this}connectedCallback(){this._state={...this._state,...c,prop:s(this,!0)};const t=l(this._state,(()=>{h(this._state),o.render(this.$root,{...this._state,...L})&&r.updated.call(this.context),"hidden"===this.style.visibility&&this.style.removeProperty("visibility")}));this.disconnectStore=n(t),this.$root.innerHTML=o.html,this.context={...i,...p,data:t,el:this.$root,prop:this._state.prop,$store:r.$store},function(t,r){function n(t){Array.from(t.querySelectorAll(`[${d}]`)).map((t=>{(t.getAttribute(d)||"").split(",").filter((t=>t)).map((e=>{t[`on${e}`]=n=>{n.preventDefault();const o=t.getAttribute(f(e));r[o].call(r,n)}}))}))}Array.from(t.querySelectorAll("[dl--bind]")).map((t=>{const n=e(r.data,t.getAttribute("dl--bind"));try{"INPUT"===t.tagName&&["radio","checkbox"].includes(t.type)?n.includes(t.value)&&(t.checked=!0):t.value=n}catch(t){}}));const o=new MutationObserver((t=>{[...t].filter((t=>t.addedNodes.length>0)).map((t=>t.target)).map((t=>n(t)))}));o.observe(t,{attributes:!0,childList:!0,subtree:!0}),n(t)}(this.$root,{...this.context,__$bindInput:_}),O(this,i,this.context),h(this._state),o.render(this.$root,{...this._state,...L}),r.created.call(this.context)}disconnectedCallback(){r.removed.call(this.context),this.disconnectStore()}get data(){return a(this._state)}}),b}async function H(t){return await fetch(t).then((t=>{if(t.status>=400)throw new Error(`${t.url} (${t.status})`);return t})).then((t=>(t.headers.get("content-type")||"").includes("json")?t.json():t.text()))}function P(t){const e={el:null,refId:null,template:null,tagName:null,shadowDOM:!0,debug:!1,...t},r=!e.tagName;if(e.tagName=e.tagName||`dlite-${Math.random().toString(36).substring(2,9).toLowerCase()}`,e.el){if("string"==typeof e.el){const t=document.querySelector(e.el);if(!t)throw new Error(`'${e.el}' could not be found.`);e.el=t}if(e.template||(e.template=e.el.innerHTML),e.el.innerHTML="",r){const t=document.createElement(e.tagName);for(const[r,n]of Object.entries(s(e.el)))t.setAttribute(r,n);e.el.parentNode.replaceChild(t,e.el)}}else if(!e.el&&r)throw new Error("Missing either 'el' or 'tagName' setting.");if(!e.template)throw new Error("Missing 'template' setting.");return S(e)}var q=(t,e={})=>Array.isArray(t)?t.map(((t,r)=>{try{return P({...e,...t})}catch(n){if(!e.debug&&!t.debug)throw n;{const t=document.createElement("div");t.style.cssText="background-color: red; color: white; padding: 10px;",t.innerHTML=`<h1 style="margin: 0;">Component ${r+1}</h1>${n}<details><summary>Stacktrace</summary>${n.stack.replaceAll("\n","<br />")}</details>`,document.body.prepend(t),console.error(n)}}})):P(t);export{q as default,H as fetcher};
